<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的响应式网页 (终极诊断版)</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>欢迎来到我的网页</h1>
        <p>这是一个展示响应式设计的示例页面。</p>
    </header>

    <main>
        <section class="text-section">
            <h2>关于我们</h2>
            <p>我们致力于提供高质量的信息和内容。</p>
        </section>
        <section class="image-section">
            <h2>精选图片</h2>
            <div class="image-gallery">
                <img src="微信图片_20240327102309.png" alt="图片1">
            </div>
        </section>

        <section class="datawrapper-table-section">
            <h2>可筛选数据表格</h2>
            <p>点击下面的按钮，可以直接筛选表格中的数据。</p>
            
            <style>
                .filter-buttons { margin-bottom: 15px; font-family: Arial, sans-serif; display: flex; flex-wrap: wrap; gap: 10px; }
                .filter-btn { display: inline-block; padding: 8px 16px; font-size: 14px; color: #fff; background-color: #007bff; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s ease; }
                .filter-btn:hover { background-color: #0056b3; }
            </style>
            
            <div class="filter-buttons">
                <strong>按分类筛选: </strong>
                <button class="filter-btn" onclick="filterTable('厨卫')">厨卫</button>
                <button class="filter-btn" onclick="filterTable('冰箱')">冰箱</button>
                <button class="filter-btn" onclick="filterTable('洗衣机')">洗衣机</button>
                <button class="filter-btn" onclick="filterTable('')">显示全部</button>
            </div>
            
            <div id="datawrapper-vis-oXdYf" style="width: 100%; min-height: 500px;">
                <script type="text/javascript" defer src="https://datawrapper.dwcdn.net/oXdYf/embed.js" charset="utf-8"></script>
            </div>
        </section>
        <section class="table-section">
            <h2>数据表格</h2>
            <table>
                </table>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 我的响应式网页. 保留所有权利。</p>
    </footer>

    <script type="text/javascript">
        // 定义我们的筛选函数，并将其附加到全局 window 对象上，以确保 onclick 可以找到它
        window.filterTable = function(category) {
            
            // 日志1：记录按钮点击事件
            console.log("按钮被点击，准备筛选分类:", category || "显示全部");

            var container = document.getElementById('datawrapper-vis-oXdYf');
            var baseUrl = 'https://datawrapper.dwcdn.net/oXdYf/3/';
            var newSrc = category ? baseUrl + '?search=' + encodeURIComponent(category) : baseUrl;

            var attempts = 0;
            var maxAttempts = 50; 
            
            // 日志2：开始检查 iframe 是否存在
            console.log("开始循环检查 iframe...");

            var checker = setInterval(function() {
                var iframe = container.querySelector('iframe');
                attempts++;

                if (iframe) {
                    // 日志3：成功找到 iframe
                    console.log("第 " + attempts + " 次尝试：成功找到 iframe！");
                    clearInterval(checker); // 停止检查

                    if (iframe.src !== newSrc) {
                        // 日志4：准备更新 iframe 链接
                        console.log("准备更新 iframe 链接为:", newSrc);
                        iframe.src = newSrc; // 执行筛选
                    } else {
                        console.log("链接已经是最新，无需更新。");
                    }
                } 
                else if (attempts > maxAttempts) {
                    // 日志5：超时错误
                    console.error("错误：加载表格超时！");
                    clearInterval(checker); // 停止检查
                    alert('错误：加载表格超时，请刷新页面重试。');
                }
            }, 100);
        }
    </script>
</body>
</html>
